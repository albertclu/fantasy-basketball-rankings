name: Scrape ESPN Fantasy Basketball Data

on:
  schedule:
      # Run every day at 10 AM UTC
          - cron: '0 10 * * *'
            workflow_dispatch: # Allow manual trigger

            jobs:
              scrape:
                  runs-on: ubuntu-latest

                          steps:
                              - name: Checkout repository
                                    uses: actions/checkout@v3
                                          with:
                                                  token: ${{ secrets.GITHUB_TOKEN }}

                                                          - name: Setup Node.js
                                                                uses: actions/setup-node@v3
                                                                      with:
                                                                              node-version: '18'

                                                                                      - name: Install dependencies
                                                                                            run: npm install node-fetch cheerio

                                                                                                    - name: Create data directory
                                                                                                          run: mkdir -p data
                                                                                                              
                                                                                                                  - name: Run scraper
                                                                                                                        run: node scraper.js
                                                                                                                            
                                                                                                                                - name: Commit and push changes
                                                                                                                                      run: |
                                                                                                                                              git config --global user.name "ESPN Scraper Bot"
                                                                                                                                                      git config --global user.email "scraper@bot.local"
                                                                                                                                                              if git diff --quiet data/teams.json; then
                                                                                                                                                                        echo "No changes in data"
                                                                                                                                                                                else
                                                                                                                                                                                          git add data/teams.json
                                                                                                                                                                                                    git commit -m "Update ESPN Fantasy Basketball stats - $(date +'%Y-%m-%d %H:%M:%S')"
                                                                                                                                                                                                              git push origin main
                                                                                                                                                                                                                      fi
                                                                                                                                                                                                                      
